
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>K-Nearest Neighbors Classifier &#8212; The Machine Learning Simplified book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://c6.patreon.com/becomePatronButton.bundle.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter2/knn';</script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Regression" href="../chapter3/linear_regression.html" />
    <link rel="prev" title="About" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/mls_logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/mls_logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        K-Nearest Neighbors (KNN) Classifier
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/linear_regression.html">
                        Linear Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/cost_function.html">
                        Cost Function
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/gradient_descent.html">
                        Gradient Descent
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter4/basis_expansion.html">
                        Basis Expansion
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter4/regularization.html">
                        Regularization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter5/bias_variance_decomposition.html">
                        Bias-variance Decomposition
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter5/validation_methods.html">
                        Cross-validation Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter6/filter_methods.html">
                        Filter Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter6/search_methods.html">
                        Search Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/data_cleaning.html">
                        Data Cleaning
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/feature_transformation.html">
                        Feature Transformation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/data_augmentation.html">
                        Data Augmentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter8/decision_tree_regressor.html">
                        Decision Tree in Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter8/decision_tree_classifier.html">
                        Decision Tree in Classification
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter9/bagging.html">
                        Bagging Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter9/boosting.html">
                        Boosting Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter10/logistic_regression.html">
                        Logistic Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter11/svm.html">
                        Support Vector Machines
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter12/tuning.html">
                        Hyper-parameters Tuning
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter13/evaluation_reg.html">
                        Model Evaluation for Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter13/evaluation_class.html">
                        Model Evaluation for Classification
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        K-Nearest Neighbors (KNN) Classifier
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/linear_regression.html">
                        Linear Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/cost_function.html">
                        Cost Function
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter3/gradient_descent.html">
                        Gradient Descent
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter4/basis_expansion.html">
                        Basis Expansion
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter4/regularization.html">
                        Regularization
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter5/bias_variance_decomposition.html">
                        Bias-variance Decomposition
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter5/validation_methods.html">
                        Cross-validation Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter6/filter_methods.html">
                        Filter Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter6/search_methods.html">
                        Search Methods
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/data_cleaning.html">
                        Data Cleaning
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/feature_transformation.html">
                        Feature Transformation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter7/data_augmentation.html">
                        Data Augmentation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter8/decision_tree_regressor.html">
                        Decision Tree in Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter8/decision_tree_classifier.html">
                        Decision Tree in Classification
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter9/bagging.html">
                        Bagging Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter9/boosting.html">
                        Boosting Models
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter10/logistic_regression.html">
                        Logistic Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter11/svm.html">
                        Support Vector Machines
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter12/tuning.html">
                        Hyper-parameters Tuning
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter13/evaluation_reg.html">
                        Model Evaluation for Regression
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../chapter13/evaluation_class.html">
                        Model Evaluation for Classification
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/mls_logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/mls_logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    </div>
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    About
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 2 - Overview of Supervised Learning</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">K-Nearest Neighbors (KNN) Classifier</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 3 - Model Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter3/linear_regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/cost_function.html">Cost Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter3/gradient_descent.html">Gradient Descent</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 4 - Basis Expansion &amp; Regularization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter4/basis_expansion.html">Basis Expansion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter4/regularization.html">Regularization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 5 - Model Selection</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter5/bias_variance_decomposition.html">Bias-variance Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter5/validation_methods.html">Cross-validation Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 6 - Feature Selection</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter6/filter_methods.html">Filter Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter6/search_methods.html">Search Methods</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 7 - Data Preparation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter7/data_cleaning.html">Data Cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter7/feature_transformation.html">Feature Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter7/data_augmentation.html">Data Augmentation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 8 - Decision Trees</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter8/decision_tree_regressor.html">Decision Trees in Regression</a></li>



<li class="toctree-l1"><a class="reference internal" href="../chapter8/decision_tree_classifier.html">Decision Trees in Classification</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 9 - Ensemble Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter9/bagging.html">Bagging Models</a></li>




<li class="toctree-l1"><a class="reference internal" href="../chapter9/boosting.html">Boosting Models</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 10 - Logit Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter10/logistic_regression.html">Logistic Regression</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 11 - Maximum Margin Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter11/svm.html">Support Vector Machines</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 12 - Model Tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter12/tuning.html">Hyper-parameters Tuning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">CHAPTER 13 - Model Evaluation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../chapter13/evaluation_reg.html">Model Evaluation for Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter13/evaluation_class.html">Model Evaluation for Classification</a></li>
</ul>

    </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        <label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" data-toggle="tooltip" data-placement="right" title="Toggle primary sidebar">
            <span class="fa-solid fa-bars"></span>
        </label>
    </div>
    <div class="header-article__right">


<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
  </ul>
</div>

<button onclick="toggleFullScreen()"
  class="btn btn-sm"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<div class="dropdown dropdown-repository-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="https://github.com/5x12/themlsbook" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">repository</span>
</a>
</a>
      
      <li><a href="https://github.com/5x12/themlsbook/issues/new?title=Issue%20on%20page%20%2Fchapter2/knn.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">open issue</span>
</a>
</a>
      
      <li><a href="https://github.com/5x12/themlsbook/edit/master/jupyter_book/chapter2/knn.md" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">suggest edit</span>
</a>
</a>
      
  </ul>
</div>



<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="../_sources/chapter2/knn.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</a>
      
      <li><a href="../_sources/chapter2/knn.md" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</a>
      
      <li>
<button onclick="printPdf(this)"
  class="btn btn-sm dropdown-item"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</a>
      
  </ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary" data-toggle="tooltip" data-placement="left" title="Toggle secondary sidebar">
            <span class="fa-solid fa-list"></span>
        </label>
    </div>
</div>
            </div>
            
            

<div id="jb-print-docs-body" class="onlyprint">
    <h1>K-Nearest Neighbors Classifier</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#required-libraries-functions">
   1. Required Libraries &amp; Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probelm-representation">
   2. Probelm Representation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-hypothetical-dataset">
     2.1. Create Hypothetical Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-the-dataset">
     2.2. Visualize the Dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-a-prediction-function">
   3. Learning a Prediction Function
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-a-knn-classifier">
     3.1. Build a KNN Classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vizualize-knn-decision-regions">
     3.2. Vizualize KNN Decision Regions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predict-unknown-values">
     3.3. Predict unknown values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-good-is-our-prediction-function">
   4. How Good is our Prediction Function?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-on-train-set">
     4.1. Evaluate on Train Set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-on-test-set">
     4.2. Evaluate on Test Set
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-complexity">
   5. Model Complexity
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#view-different-scenarios">
     5.1. View Different Scenarios
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-1">
       5.1.1. K = 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-2">
       5.1.2. K = 2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-5">
       5.1.3. K = 5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-n">
       5.1.4. K = N
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tune-hyperparameters">
     5.2. Tune Hyperparameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-misclassification-error-rates">
     5.3. Plot Misclassification Error Rates
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>

            <article class="bd-article" role="main">
              
  <section class="tex2jax_ignore mathjax_ignore" id="k-nearest-neighbors-classifier">
<span id="chapter2-part1"></span><h1>K-Nearest Neighbors Classifier<a class="headerlink" href="#k-nearest-neighbors-classifier" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>This is a supplement material for the <a class="reference external" href="https://themlsbook.com">Machine Learning Simplified</a> book. It sheds light on Python implementations of the topics discussed while all detailed explanations can be found in the book.</p></li>
<li><p>I also assume you know Python syntax and how it works. If you don’t, I highly recommend you to take a break and get introduced to the language before going forward with my code.</p></li>
<li><p>This material can be downloaded as a Jupyter notebook (Download button in the upper-right corner -&gt; <code class="docutils literal notranslate"><span class="pre">.ipynb</span></code>) to reproduce the code and play around with it.</p></li>
</ul>
<section id="required-libraries-functions">
<h2>1. Required Libraries &amp; Functions<a class="headerlink" href="#required-libraries-functions" title="Permalink to this heading">#</a></h2>
<p>Before we start, we need to import few libraries and functions that we will use in this jupyterbook. You don’t need to understand what those functions do for now.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39; # sharper plots


<span class="c1"># Create a function to plot scatter graph</span>
<span class="k">def</span> <span class="nf">plotFruitFigure</span><span class="p">():</span>
    <span class="c1"># Define variables for graph</span>
    <span class="n">apple_height</span><span class="p">,</span> <span class="n">apple_width</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Apple&#39;</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Apple&#39;</span><span class="p">]</span>
    <span class="n">mandarin_height</span><span class="p">,</span> <span class="n">mandarin_width</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">]</span>
    <span class="n">lemon_height</span><span class="p">,</span> <span class="n">lemon_width</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">height</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">width</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span> <span class="o">==</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">]</span>

    <span class="c1"># Initialize the graph</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

    <span class="c1"># Plot defined variables on it</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">apple_height</span><span class="p">,</span> <span class="n">apple_width</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;apple&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mandarin_height</span><span class="p">,</span> <span class="n">mandarin_width</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mandarin&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lemon_height</span><span class="p">,</span> <span class="n">lemon_width</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;lemon&#39;</span><span class="p">)</span>

    <span class="c1"># Show legend and configure graph&#39;s size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;KNN Fruits Scatter Plot&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span> 
    
<span class="c1"># Create a function to plot KNN&#39;s decision regions</span>
<span class="k">def</span> <span class="nf">plotKNN</span><span class="p">(</span>
    <span class="n">n_neighbors</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> 
            <span class="n">plot_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">plot_height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">plot_width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">plot_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="c1"># Turn categorical target variable into numerical to make a graph</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y_encoded</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;fruit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span> <span class="c1">#encoded y</span>

    <span class="c1"># Create color maps for graph</span>
    <span class="n">cmap_light</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="s1">&#39;lightgreen&#39;</span><span class="p">])</span>
    <span class="n">cmap_bold</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>

    <span class="c1"># We want to visualize KNN with 1 nearest neighbor.</span>
    <span class="c1"># Let&#39;s initialize the model and train it with the dataset</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">)</span>

    <span class="c1"># Plot the decision boundary. For that, we will assign a color to each point in the mesh</span>
    <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span>
    <span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span>

    <span class="n">h</span> <span class="o">=</span> <span class="mf">.02</span>  <span class="c1"># step size in the mesh</span>
    <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span>
                         <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_min</span><span class="p">,</span> <span class="n">y_max</span><span class="p">,</span> <span class="n">h</span><span class="p">))</span>

    <span class="n">Z</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span>

    <span class="c1"># Put the result into a color plot</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap_light</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">plot_data</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="c1"># Plot also the dataset observations</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">plot_height</span><span class="p">,</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span><span class="c1">#y=X[:, 1], </span>
                        <span class="n">hue</span><span class="o">=</span><span class="n">plot_labels</span><span class="p">,</span><span class="c1">#df.fruit.values,</span>
                        <span class="n">palette</span><span class="o">=</span><span class="n">cmap_bold</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> 
                        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>

    <span class="c1"># Configure the graph</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s1">&#39;box&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;KNN Fruits Classifier, n=</span><span class="si">{</span><span class="n">n_neighbors</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;height&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;width&quot;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
</div>
</section>
<section id="probelm-representation">
<h2>2. Probelm Representation<a class="headerlink" href="#probelm-representation" title="Permalink to this heading">#</a></h2>
<p>Let’s recall Chapter 2 of <a class="reference external" href="https://themlsbook.com">the Machine Learning Simplified book</a>. We have a hypothetical dataset (Table 2.1 in the MLS book) containing 20 fruits that are a mix of <code class="docutils literal notranslate"><span class="pre">apples</span></code>, <code class="docutils literal notranslate"><span class="pre">mandarins</span></code>, and <code class="docutils literal notranslate"><span class="pre">lemons</span></code> For each fruit, we have measured it’s <code class="docutils literal notranslate"><span class="pre">height</span></code> and <code class="docutils literal notranslate"><span class="pre">width</span></code> and recorded them as the first two columns of the table. For each fruit we know its <code class="docutils literal notranslate"><span class="pre">type</span></code>, or class label, and this is represented by the last column.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>height</p></th>
<th class="head"><p>width</p></th>
<th class="head"><p>fruit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.91</p></td>
<td><p>5.76</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-odd"><td><p>7.09</p></td>
<td><p>7.69</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-even"><td><p>10.48</p></td>
<td><p>7.32</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-odd"><td><p>9.21</p></td>
<td><p>7.20</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-even"><td><p>7.95</p></td>
<td><p>5.90</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-odd"><td><p>7.62</p></td>
<td><p>7.51</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-even"><td><p>7.95</p></td>
<td><p>7.51</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>8.42</p></td>
<td><p>5.32</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-even"><td><p>4.69</p></td>
<td><p>6.19</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-odd"><td><p>7.50</p></td>
<td><p>5.99</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-even"><td><p>7.11</p></td>
<td><p>7.02</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>4.15</p></td>
<td><p>5.60</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-even"><td><p>7.29</p></td>
<td><p>8.38</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>8.49</p></td>
<td><p>6.52</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-even"><td><p>7.44</p></td>
<td><p>7.89</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>7.86</p></td>
<td><p>7.60</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-even"><td><p>3.93</p></td>
<td><p>6.12</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>4.40</p></td>
<td><p>5.90</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-even"><td><p>8.10</p></td>
<td><p>6.15</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-odd"><td><p>8.69</p></td>
<td><p>5.82</p></td>
<td><p>Lemon</p></td>
</tr>
</tbody>
</table>
<section id="create-hypothetical-dataset">
<h3>2.1. Create Hypothetical Dataset<a class="headerlink" href="#create-hypothetical-dataset" title="Permalink to this heading">#</a></h3>
<p>Let’s re-create aforementioned table in python. We use <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library - a library that manages <strong>PAN</strong>el <strong>DA</strong>ta <strong>S</strong>ets - to do so. Note that we have already imported it in the beginning of this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#re-create a hypothetical dataset</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.91</span><span class="p">,</span> <span class="mf">7.09</span><span class="p">,</span> <span class="mf">10.48</span><span class="p">,</span> <span class="mf">9.21</span><span class="p">,</span> <span class="mf">7.95</span><span class="p">,</span> <span class="mf">7.62</span><span class="p">,</span> <span class="mf">7.95</span><span class="p">,</span> <span class="mf">4.69</span><span class="p">,</span> <span class="mf">7.50</span><span class="p">,</span> <span class="mf">7.11</span><span class="p">,</span> <span class="mf">4.15</span><span class="p">,</span> <span class="mf">7.29</span><span class="p">,</span> <span class="mf">8.49</span><span class="p">,</span> <span class="mf">7.44</span><span class="p">,</span> <span class="mf">7.86</span><span class="p">,</span> <span class="mf">3.93</span><span class="p">,</span> <span class="mf">4.40</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">8.10</span><span class="p">,</span> <span class="mf">8.69</span><span class="p">],</span> 
        <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.76</span><span class="p">,</span> <span class="mf">7.69</span><span class="p">,</span> <span class="mf">7.32</span><span class="p">,</span> <span class="mf">7.20</span><span class="p">,</span> <span class="mf">5.90</span><span class="p">,</span> <span class="mf">7.51</span><span class="p">,</span> <span class="mf">5.32</span><span class="p">,</span> <span class="mf">6.19</span><span class="p">,</span> <span class="mf">5.99</span><span class="p">,</span> <span class="mf">7.02</span><span class="p">,</span> <span class="mf">5.60</span><span class="p">,</span> <span class="mf">8.38</span><span class="p">,</span> <span class="mf">6.52</span><span class="p">,</span> <span class="mf">7.89</span><span class="p">,</span> <span class="mf">7.60</span><span class="p">,</span> <span class="mf">6.12</span><span class="p">,</span> <span class="mf">5.90</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">,</span> <span class="mf">6.15</span><span class="p">,</span> <span class="mf">5.82</span><span class="p">],</span>
        <span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">]</span>
       <span class="p">}</span>  

<span class="c1">#transform dataset into a DataFrame df using pandas library</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>  
  
<span class="c1">#print the output</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>width</th>
      <th>fruit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.91</td>
      <td>5.76</td>
      <td>Mandarin</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.09</td>
      <td>7.69</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10.48</td>
      <td>7.32</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.21</td>
      <td>7.20</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.95</td>
      <td>5.90</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7.62</td>
      <td>7.51</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7.95</td>
      <td>5.32</td>
      <td>Mandarin</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4.69</td>
      <td>6.19</td>
      <td>Mandarin</td>
    </tr>
    <tr>
      <th>8</th>
      <td>7.50</td>
      <td>5.99</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.11</td>
      <td>7.02</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>10</th>
      <td>4.15</td>
      <td>5.60</td>
      <td>Mandarin</td>
    </tr>
    <tr>
      <th>11</th>
      <td>7.29</td>
      <td>8.38</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>12</th>
      <td>8.49</td>
      <td>6.52</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>13</th>
      <td>7.44</td>
      <td>7.89</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>14</th>
      <td>7.86</td>
      <td>7.60</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3.93</td>
      <td>6.12</td>
      <td>Apple</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4.40</td>
      <td>5.90</td>
      <td>Mandarin</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5.50</td>
      <td>4.50</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>18</th>
      <td>8.10</td>
      <td>6.15</td>
      <td>Lemon</td>
    </tr>
    <tr>
      <th>19</th>
      <td>8.69</td>
      <td>5.82</td>
      <td>Lemon</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="visualize-the-dataset">
<h3>2.2. Visualize the Dataset<a class="headerlink" href="#visualize-the-dataset" title="Permalink to this heading">#</a></h3>
<p>Let’s now build a plot to visualize the dataset. We will plot the same graph that we had in the Machine Learning Simplified book. To make things easier, we can do so by simply calling the funtion <code class="docutils literal notranslate"><span class="pre">plotFruitFigure()</span></code> that we defined in the beginning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotFruitFigure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bf8e1c708f97c952d00ebf34c705f3e4f54a384ff5e9415bfb696abbec409189.png" src="../_images/bf8e1c708f97c952d00ebf34c705f3e4f54a384ff5e9415bfb696abbec409189.png" />
</div>
</div>
</section>
</section>
<section id="learning-a-prediction-function">
<h2>3. Learning a Prediction Function<a class="headerlink" href="#learning-a-prediction-function" title="Permalink to this heading">#</a></h2>
<section id="build-a-knn-classifier">
<h3>3.1. Build a KNN Classifier<a class="headerlink" href="#build-a-knn-classifier" title="Permalink to this heading">#</a></h3>
<p>Let’s build a classifier and use it to predict some values. Firstly, we define <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define X and y using the dataset</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<p>Second, we <strong>initialize</strong> our <code class="docutils literal notranslate"><span class="pre">KNN</span></code> algorithm. We use <code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code> from <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library that we loaded in the beginning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the KNN model with 1 nearest neighbor</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we pass the dataset (X and y) to that algorithm for learning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Feed the dataset into the model to train</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsClassifier(n_neighbors=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked><label for="sk-estimator-id-1" class="sk-toggleable__label sk-toggleable__label-arrow">KNeighborsClassifier</label><div class="sk-toggleable__content"><pre>KNeighborsClassifier(n_neighbors=1)</pre></div></div></div></div></div></div></div>
</div>
</section>
<section id="vizualize-knn-decision-regions">
<h3>3.2. Vizualize KNN Decision Regions<a class="headerlink" href="#vizualize-knn-decision-regions" title="Permalink to this heading">#</a></h3>
<p>Now that the model is ready, let’s visualize the decision boundaries of KNN on a graph, like we did in the MLS book. To simplify things, we will simply use <code class="docutils literal notranslate"><span class="pre">plotKNN</span></code> function that we defined in the beginning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
        <span class="n">plot_height</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> 
        <span class="n">plot_width</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> 
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e8621c8a8b564bb735ddbc1749162b496eab732e5a6e68df33e28ed661b794e1.png" src="../_images/e8621c8a8b564bb735ddbc1749162b496eab732e5a6e68df33e28ed661b794e1.png" />
</div>
</div>
<p>We can remove the datapoints - after the learning is done, we don’t need them anymore. Hence, we can set a parameter <code class="docutils literal notranslate"><span class="pre">plot_data=False</span></code> to see our trained model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/146bacb5ead5b2b020840bf90fa50c8a1fc4eaa5ae4c6bfd42b03be0cb49bd81.png" src="../_images/146bacb5ead5b2b020840bf90fa50c8a1fc4eaa5ae4c6bfd42b03be0cb49bd81.png" />
</div>
</div>
<p>Figure above shows the learned decision regions of a model, or specifically, it shows how this classifier predicts the (unknown) type of a new fruit with height and width measurements. For instance, if there is an unknown data point with measurements (4cm,5cm), it lands in the green region so the classifier predicts mandarin.</p>
</section>
<section id="predict-unknown-values">
<h3>3.3. Predict unknown values<a class="headerlink" href="#predict-unknown-values" title="Permalink to this heading">#</a></h3>
<p>Let’s predict unknown fruits using our trained classifier. Let’s try to predict the label for an unknown fruit with width of 9cm and height of 3cm:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prediction for a single data point</span>
<span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Mandarin&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>We can predict values for a whole bunch of them!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prediction for multiple data points</span>
<span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Mandarin&#39;, &#39;Mandarin&#39;, &#39;Mandarin&#39;, &#39;Apple&#39;, &#39;Mandarin&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="how-good-is-our-prediction-function">
<h2>4. How Good is our Prediction Function?<a class="headerlink" href="#how-good-is-our-prediction-function" title="Permalink to this heading">#</a></h2>
<p>The next step is to evaluate how good our model is.</p>
<section id="evaluate-on-train-set">
<h3>4.1. Evaluate on Train Set<a class="headerlink" href="#evaluate-on-train-set" title="Permalink to this heading">#</a></h3>
<p>Let’s first evaluate the score of the model on the training dataset. Remember, as we explained in the MLS book, this should be 0 in this example.</p>
<p>The first step is to “predict” the training set, as if we pretend that we don’t know training set’s labels and see if the trained model manages to guess them correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict values for the training set</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Output of predicted labels</span>
<span class="n">y_pred_train</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Mandarin&#39;, &#39;Apple&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;, &#39;Apple&#39;,
       &#39;Mandarin&#39;, &#39;Mandarin&#39;, &#39;Lemon&#39;, &#39;Apple&#39;, &#39;Mandarin&#39;, &#39;Apple&#39;,
       &#39;Lemon&#39;, &#39;Apple&#39;, &#39;Apple&#39;, &#39;Apple&#39;, &#39;Mandarin&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;,
       &#39;Lemon&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Let’s recall the actual labels for our fruits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output of actual labels</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Mandarin&#39;, &#39;Apple&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;, &#39;Apple&#39;,
       &#39;Mandarin&#39;, &#39;Mandarin&#39;, &#39;Lemon&#39;, &#39;Apple&#39;, &#39;Mandarin&#39;, &#39;Apple&#39;,
       &#39;Lemon&#39;, &#39;Apple&#39;, &#39;Apple&#39;, &#39;Apple&#39;, &#39;Mandarin&#39;, &#39;Lemon&#39;, &#39;Lemon&#39;,
       &#39;Lemon&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Let’s now calculate the difference between actual and predicted labels:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the difference between actual values y and predicted values y_pred_train</span>
<span class="n">train_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)</span>

<span class="c1"># Output</span>
<span class="n">train_score</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>1.0 means the model correctly predicted all (100%) data points from the training set. We can calculate the misclassification error rate simply as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_error</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">train_score</span>

<span class="c1"># Output</span>
<span class="n">train_error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="evaluate-on-test-set">
<h3>4.2. Evaluate on Test Set<a class="headerlink" href="#evaluate-on-test-set" title="Permalink to this heading">#</a></h3>
<p>Imagine we have new fuits with the following properties:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>height</p></th>
<th class="head"><p>width</p></th>
<th class="head"><p>fruit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>4.0</p></td>
<td><p>6.5</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-odd"><td><p>4.47</p></td>
<td><p>7.13</p></td>
<td><p>Mandarin</p></td>
</tr>
<tr class="row-even"><td><p>6.49</p></td>
<td><p>7.0</p></td>
<td><p>Apple</p></td>
</tr>
<tr class="row-odd"><td><p>7.51</p></td>
<td><p>5.01</p></td>
<td><p>Lemon</p></td>
</tr>
<tr class="row-even"><td><p>8.34</p></td>
<td><p>4.23</p></td>
<td><p>Lemon</p></td>
</tr>
</tbody>
</table>
<p>Let’s see if our model would correctly predict the fruit label from this dataset (test set). Again, we do so by showing fruits’ measurements and not revealing their labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compose the Test set</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">4.47</span><span class="p">,</span> <span class="mf">6.49</span><span class="p">,</span> <span class="mf">7.51</span><span class="p">,</span> <span class="mf">8.34</span><span class="p">],</span>
                            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.13</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">5.01</span><span class="p">,</span> <span class="mf">4.23</span><span class="p">],</span>
                            <span class="s1">&#39;fruit&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Mandarin&#39;</span><span class="p">,</span> <span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lemon&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the Test set on the trained model</span>

<span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
        <span class="n">plot_height</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45464c8a45fb0bd2272686d1331307159ad2cb772f2b487192eb10a0be2495b8.png" src="../_images/45464c8a45fb0bd2272686d1331307159ad2cb772f2b487192eb10a0be2495b8.png" />
</div>
</div>
<p>Just by eyeballing this graph, we can already see that the model made few prediction errors - some data points do not land at decision regions of the same color (this was explained in the book). Let’s verify it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predict observations</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)):</span>
    
    <span class="c1"># Initialize the KNN model with 1 nearest neighbor</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Define X and y using the dataset</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span>

    <span class="c1"># Feed the dataset into the model to train</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">test_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
    
    <span class="k">if</span> <span class="n">pred</span> <span class="o">==</span> <span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[CORRECT!] - actual observation is </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">, and the model predicted </span><span class="si">{</span><span class="n">pred</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;[WRONG!] - actual observation is </span><span class="si">{</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">, but the model predicted </span><span class="si">{</span><span class="n">pred</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[WRONG!] - actual observation is Mandarin, but the model predicted [&#39;Apple&#39;]
[CORRECT!] - actual observation is Mandarin, and the model predicted [&#39;Mandarin&#39;]
[CORRECT!] - actual observation is Apple, and the model predicted [&#39;Apple&#39;]
[WRONG!] - actual observation is Lemon, but the model predicted [&#39;Mandarin&#39;]
[WRONG!] - actual observation is Lemon, but the model predicted [&#39;Mandarin&#39;]
</pre></div>
</div>
</div>
</div>
<p>The model incorrectly predicted 3 observations out of 5. As we discussed in the MLS book, when the error is low on the training set (0%), but much higher on an unseen test set (3/5=60%), the model is overfitted. Another problem is underfitting - when test and train errors are equally high. To get a balance between these two, we tune hyperparameters of the model to pick the right model complexity (not too simple, not too complicated).</p>
</section>
</section>
<section id="model-complexity">
<h2>5. Model Complexity<a class="headerlink" href="#model-complexity" title="Permalink to this heading">#</a></h2>
<section id="view-different-scenarios">
<h3>5.1. View Different Scenarios<a class="headerlink" href="#view-different-scenarios" title="Permalink to this heading">#</a></h3>
<p>Let’s try different values of k (k=1, k=2, k-5, k=20) and visually see what happens.</p>
<section id="k-1">
<h4>5.1.1. K = 1<a class="headerlink" href="#k-1" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#selecting k=1</span>
        <span class="n">plot_height</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> 
        <span class="n">plot_width</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> 
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e8621c8a8b564bb735ddbc1749162b496eab732e5a6e68df33e28ed661b794e1.png" src="../_images/e8621c8a8b564bb735ddbc1749162b496eab732e5a6e68df33e28ed661b794e1.png" />
</div>
</div>
<p>Let’s check predictions of test data once again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
        <span class="n">plot_height</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/45464c8a45fb0bd2272686d1331307159ad2cb772f2b487192eb10a0be2495b8.png" src="../_images/45464c8a45fb0bd2272686d1331307159ad2cb772f2b487192eb10a0be2495b8.png" />
</div>
</div>
<p>Misclassifications on test set: 3 (3 data points do not have the same color as their decision region)</p>
</section>
<section id="k-2">
<h4>5.1.2. K = 2<a class="headerlink" href="#k-2" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1">#selecting k=2</span>
        <span class="n">plot_height</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> 
        <span class="n">plot_width</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> 
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/906ce1138eba80474c9d86f366e38cf822d0610666447d91101782f24c5019e8.png" src="../_images/906ce1138eba80474c9d86f366e38cf822d0610666447d91101782f24c5019e8.png" />
</div>
</div>
<p>Let’s check predictions of test data when <span class="math notranslate nohighlight">\(k=2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
        <span class="n">plot_height</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/26aed91e693b0160d93b72e4189b2e484db03c7612bfa1d29dd0d226146c5491.png" src="../_images/26aed91e693b0160d93b72e4189b2e484db03c7612bfa1d29dd0d226146c5491.png" />
</div>
</div>
<p>Misclassifications on test set: 2 (2 data points (both mandarins) do not have the same color as their decision region)</p>
</section>
<section id="k-5">
<h4>5.1.3. K = 5<a class="headerlink" href="#k-5" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="c1">#selecting k=5</span>
        <span class="n">plot_height</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> 
        <span class="n">plot_width</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> 
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4fc2feb061f3299c5f9aa5afdd834fd88937223d3f7033463bbcf3f111726c9e.png" src="../_images/4fc2feb061f3299c5f9aa5afdd834fd88937223d3f7033463bbcf3f111726c9e.png" />
</div>
</div>
<p>Let’s check predictions of test data when <span class="math notranslate nohighlight">\(k=5\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">plot_height</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0c1ce538213796f93da23641a58d07c0e6c3ab5f2fd03119ec7e5f561bbb1738.png" src="../_images/0c1ce538213796f93da23641a58d07c0e6c3ab5f2fd03119ec7e5f561bbb1738.png" />
</div>
</div>
<p>Misclassifications on test set: 0 (all data points have the same color as their decision region)</p>
</section>
<section id="k-n">
<h4>5.1.4. K = N<a class="headerlink" href="#k-n" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="c1">#selecting k=n=20</span>
        <span class="n">plot_height</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> 
        <span class="n">plot_width</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;width&#39;</span><span class="p">],</span> 
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c2026f9703080d1e295861c4d89ccadf2c31a54c81d4e6a42c6476b4a7b24fc0.png" src="../_images/c2026f9703080d1e295861c4d89ccadf2c31a54c81d4e6a42c6476b4a7b24fc0.png" />
</div>
</div>
<p>Let’s check predictions of test data when <span class="math notranslate nohighlight">\(k=n=20\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotKNN</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">plot_height</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">plot_width</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="n">plot_labels</span><span class="o">=</span><span class="n">test_data</span><span class="o">.</span><span class="n">fruit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7d0910d3388d8b5c9ff7d818f0f461061a42d0a1b8e6261c5fce2bdec5f2e76b.png" src="../_images/7d0910d3388d8b5c9ff7d818f0f461061a42d0a1b8e6261c5fce2bdec5f2e76b.png" />
</div>
</div>
<p>Misclassifications on test set: 4 (only one dataapoint (apple) has the same color as its decision region)</p>
</section>
</section>
<section id="tune-hyperparameters">
<h3>5.2. Tune Hyperparameters<a class="headerlink" href="#tune-hyperparameters" title="Permalink to this heading">#</a></h3>
<p>Now, for each <code class="docutils literal notranslate"><span class="pre">k</span></code> let’s calculate train_error and test_error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define X and y using the dataset</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fruit</span><span class="o">.</span><span class="n">values</span>

<span class="n">train_errors</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_errors</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">k</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_misclassifications</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">train_misclassifications</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)):</span>
    <span class="n">_k</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
    
    <span class="c1"># STEP 1: Again, initialize the model</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="n">_k</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># STEP 2: make predictions on the test and train sets</span>
    <span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">[[</span><span class="s1">&#39;height&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">]])</span>

    <span class="c1"># STEP 4: Compare actual response values (y_train and y_test) with predicted response values (y_pred_train, y_pred_test)</span>
    <span class="n">train_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">)</span>
    <span class="n">test_score</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">test_data</span><span class="p">[[</span><span class="s1">&#39;fruit&#39;</span><span class="p">]],</span> <span class="n">y_pred_test</span><span class="p">)</span>
    
    <span class="c1"># STEP 5: Calculate train error and test error</span>
    <span class="n">_train_error</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">train_score</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">_test_error</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">test_score</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>


    <span class="n">k</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_k</span><span class="p">)</span>
    <span class="n">train_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_train_error</span><span class="p">)</span>
    <span class="n">test_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_test_error</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;k=</span><span class="si">{</span><span class="n">_k</span><span class="si">}</span><span class="s1"> | train error: </span><span class="si">{</span><span class="n">train_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> | test error: </span><span class="si">{</span><span class="n">test_errors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1"> | train misclassifications: </span><span class="si">{</span><span class="n">_train_error</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="si">}</span><span class="s1"> | test misclassifications: </span><span class="si">{</span><span class="n">_test_error</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>k=1 | train error: 0.0 | test error: 0.6 | train misclassifications: 0.0 | test misclassifications: 3.0
k=2 | train error: 0.05 | test error: 0.4 | train misclassifications: 1.0 | test misclassifications: 2.0
k=3 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=4 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=5 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=6 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=7 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=8 | train error: 0.15 | test error: 0.0 | train misclassifications: 3.0 | test misclassifications: 0.0
k=9 | train error: 0.15 | test error: 0.2 | train misclassifications: 3.0 | test misclassifications: 1.0
k=10 | train error: 0.15 | test error: 0.4 | train misclassifications: 3.0 | test misclassifications: 2.0
k=11 | train error: 0.2 | test error: 0.4 | train misclassifications: 4.0 | test misclassifications: 2.0
k=12 | train error: 0.1 | test error: 0.4 | train misclassifications: 2.0 | test misclassifications: 2.0
k=13 | train error: 0.35 | test error: 0.4 | train misclassifications: 7.0 | test misclassifications: 2.0
k=14 | train error: 0.45 | test error: 0.4 | train misclassifications: 9.0 | test misclassifications: 2.0
k=15 | train error: 0.45 | test error: 0.4 | train misclassifications: 9.0 | test misclassifications: 2.0
k=16 | train error: 0.55 | test error: 0.4 | train misclassifications: 11.0 | test misclassifications: 2.0
k=17 | train error: 0.5 | test error: 0.4 | train misclassifications: 10.0 | test misclassifications: 2.0
k=18 | train error: 0.5 | test error: 0.4 | train misclassifications: 10.0 | test misclassifications: 2.0
k=19 | train error: 0.6 | test error: 0.6 | train misclassifications: 12.0 | test misclassifications: 3.0
k=20 | train error: 0.6 | test error: 0.6 | train misclassifications: 12.0 | test misclassifications: 3.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
/Users/andrewwolf/.pyenv/versions/3.10.7/lib/python3.10/site-packages/sklearn/base.py:402: UserWarning: X has feature names, but KNeighborsClassifier was fitted without feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-misclassification-error-rates">
<h3>5.3. Plot Misclassification Error Rates<a class="headerlink" href="#plot-misclassification-error-rates" title="Permalink to this heading">#</a></h3>
<p>Now, let’s plot a graph that shows misclassification error rate for training and test sets as we vary <span class="math notranslate nohighlight">\(k\)</span>, the number of neighbors in our KNN model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot train error rates</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">train_errors</span><span class="p">)</span> <span class="c1">#function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">train_errors</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)</span> <span class="c1">#data points</span>

<span class="c1"># Plot test error rates</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">test_errors</span><span class="p">)</span> <span class="c1">#function</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">test_errors</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span> <span class="c1">#data points</span>

<span class="c1"># Plot configurations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;number of nearest neighbours (k)&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;misclassification (error) rate&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Model Performance vs Complexity&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Output</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cca4ac9c7fe6f7f801fa81ef33623626f330e085981a9c5a43a567d9f0aec2f7.png" src="../_images/cca4ac9c7fe6f7f801fa81ef33623626f330e085981a9c5a43a567d9f0aec2f7.png" />
</div>
</div>
<p>Models on the left side of the plot (near <span class="math notranslate nohighlight">\(k=n=20\)</span>) use too large a neighborhood and produce an underfit model. Models on the right side of the plot (near <span class="math notranslate nohighlight">\(k=1\)</span>) use too small a neighborhood and produce an overfit model. Models between <span class="math notranslate nohighlight">\(k=3\)</span> and <span class="math notranslate nohighlight">\(k=7\)</span> perform optimally on the test set – in other words, they optimally balance overfitting and underfitting.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapter2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            </article>
            

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="../index.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">About</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="../chapter3/linear_regression.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Linear Regression</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#required-libraries-functions">
   1. Required Libraries &amp; Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#probelm-representation">
   2. Probelm Representation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-hypothetical-dataset">
     2.1. Create Hypothetical Dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualize-the-dataset">
     2.2. Visualize the Dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-a-prediction-function">
   3. Learning a Prediction Function
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-a-knn-classifier">
     3.1. Build a KNN Classifier
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vizualize-knn-decision-regions">
     3.2. Vizualize KNN Decision Regions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#predict-unknown-values">
     3.3. Predict unknown values
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#how-good-is-our-prediction-function">
   4. How Good is our Prediction Function?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-on-train-set">
     4.1. Evaluate on Train Set
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#evaluate-on-test-set">
     4.2. Evaluate on Test Set
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-complexity">
   5. Model Complexity
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#view-different-scenarios">
     5.1. View Different Scenarios
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-1">
       5.1.1. K = 1
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-2">
       5.1.2. K = 2
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-5">
       5.1.3. K = 5
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#k-n">
       5.1.4. K = N
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tune-hyperparameters">
     5.2. Tune Hyperparameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-misclassification-error-rates">
     5.3. Plot Misclassification Error Rates
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Andrew Wolf
</p>

  </div>
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
Last updated on None.<br>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </div>
        </footer>
        

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  </body>
</html>